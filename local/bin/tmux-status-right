#!/bin/bash

local_datetime=$(TZ=US/Pacific date +"%Y-%m-%d T %H:%M")
utc_time=$(date +'%H:%M' --utc)

local_date=$(TZ=US/Pacific date +"%Y-%m-%d")
utc_date=$(date +"%Y-%m-%d" --utc)

if [[ $utc_date == "$local_date" ]]; then
    utc_datetime="/ #[fg=colour250,bold]${utc_time}Z"
else
    utc_month_day=$(date +'%m-%d' --utc)
    utc_datetime="/ #[fg=colour250,bold]${utc_time}Z $utc_month_day"
fi
status_right="â•‘ $local_datetime $utc_datetime"

if [[ ! -e /var/run/reboot-required ]]; then
    status_right="$(hostname) $status_right"
    tmux set-option -g status-style bg=colour237,fg=colour245
else
    tmux set-option -g status-style bg=colour160,fg=colour15
    status_right="REBOOT $status_right"
fi

status_len=${#status_right}
tmux set-option -g status-right-length "$status_len"
echo "$status_right"
